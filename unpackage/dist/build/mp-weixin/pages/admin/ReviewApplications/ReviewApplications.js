"use strict";const e=require("../../../common/vendor.js"),n={__name:"ReviewApplications",setup(n){const i=e.ref([]);async function t(){const{result:n}=await e.nr.callFunction({name:"getPendingApplications"});n.success?i.value=n.data:e.index.showToast({title:n.msg||"加载失败",icon:"none"})}async function o(n,i){let o="";if("reject"===i){const{confirm:n,content:i}=await new Promise((n=>{e.index.showModal({title:"拒绝原因",placeholderText:"请输入原因",editable:!0,success:n})}));if(!n)return;o=i}e.index.showLoading({title:"提交审核..."});try{const c=await e.nr.callFunction({name:"reviewTechnicianApplication",data:{uid:n,action:i,reason:o}});console.log("reviewTechnicianApplication 返回：",c),e.index.hideLoading(),c.result&&c.result.success?(e.index.showToast({title:"操作成功",icon:"success"}),await t()):e.index.showToast({title:c.result&&c.result.msg||"操作失败",icon:"none"})}catch(c){e.index.hideLoading(),console.error("调用 reviewTechnicianApplication 错误：",c),e.index.showToast({title:"网络或服务异常",icon:"none"})}}return e.onMounted((()=>{"admin"!==(e.index.getStorageSync("userinfo")||{}).userType?(e.index.showToast({title:"无权限访问",icon:"none"}),e.index.reLaunch({url:"/pages/profile/profile"})):t()})),(n,t)=>({a:e.f(i.value,((n,i,t)=>({a:e.t(n.technicianInfo.realName),b:e.t(n.technicianInfo.idCard),c:e.t(n.technicianInfo.skills),d:e.f(n.technicianInfo.certificates,((e,n,i)=>({a:n,b:e}))),e:e.o((e=>o(n._id,"approve")),n._id),f:e.o((e=>o(n._id,"reject")),n._id),g:n._id})))})}},i=e._export_sfc(n,[["__scopeId","data-v-e760db92"]]);wx.createPage(i);
