{"version":3,"file":"user-schedule.js","sources":["pages/user-schedule/user-schedule.vue","../../../HBuilderX.4.66.2025051912/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvdXNlci1zY2hlZHVsZS91c2VyLXNjaGVkdWxlLnZ1ZQ"],"sourcesContent":["<template>\n  <view class=\"page-container\">\n    <view v-if=\"loading\" class=\"feedback-view\">\n      <view class=\"loading-indicator\">加载中...</view>\n    </view>\n    <view v-else-if=\"appointments.length === 0\" class=\"feedback-view\">\n      <view class=\"empty-message\">暂无预约记录</view>\n    </view>\n\n    <view v-else class=\"appointment-list\">\n      <view\n        class=\"appointment-card\"\n        v-for=\"item in appointments\"\n        :key=\"item._id\"\n      >\n        <view class=\"card-body\">\n          <view class=\"info-row\">\n            <text class=\"label\">服务时间</text>\n            <text class=\"value\">{{ item.serviceDate }} {{ item.serviceHour }}</text>\n          </view>\n          <view class=\"info-row\">\n            <text class=\"label\">师傅电话</text>\n            <text class=\"value\">{{ item.workerPhone }}</text>\n          </view>\n          <view class=\"info-row\" v-if=\"item.remark\">\n            <text class=\"label\">备注信息</text>\n            <text class=\"value\">{{ item.remark }}</text>\n          </view>\n          <view class=\"info-row\">\n            <text class=\"label\">服务状态</text>\n            <text class=\"value status-text\" :class=\"`status-${item.status}`\">{{ translateStatus(item.status) }}</text>\n          </view>\n          <view class=\"info-row\" v-if=\"item.review && item.review.comment\">\n            <text class=\"label\">我的评价</text>\n            <text class=\"value review-comment\">{{ item.review.comment }}</text>\n          </view>\n        </view>\n        \n        <view class=\"card-footer\">\n          <!-- 动态绑定类名，根据按钮数量调整布局 -->\n          <view class=\"button-group\" :class=\"getButtonGroupClass(item)\">\n            <!-- 场景1: 预约成功，服务时间未到 (取消 + 完成) -->\n            <template v-if=\"item.status === 'confirmed' && item.expectedEndTime && item.expectedEndTime > Date.now()\">\n              <button class=\"btn cancel\" @click=\"cancelAppointment(item)\">取消预约</button>\n              <button class=\"btn finish\" @click=\"completeAppointment(item)\">完成服务</button>\n            </template>\n\n            <!-- 场景2: 预约成功，服务时间已过但未自动完成 (联系客服 + 完成服务) -->\n            <template v-else-if=\"item.status === 'confirmed' && item.expectedEndTime && item.expectedEndTime <= Date.now()\">\n              <button class=\"btn contact\" @click=\"contactCustomerService\">联系客服</button>\n              <button class=\"btn finish\" @click=\"completeAppointment(item)\">完成服务</button>\n            </template>\n\n            <!-- 场景3: 已完成，未评价 (联系客服 + 评价服务) -->\n            <template v-else-if=\"item.status === 'completed' && !item.review\">\n              <button class=\"btn contact\" @click=\"contactCustomerService\">联系客服</button>\n              <button class=\"btn review\" @click=\"openReviewModal(item)\">评价服务</button>\n            </template>\n\n            <!-- 场景4: 已完成，已评价 (仅 联系客服) -->\n            <template v-else-if=\"item.status === 'completed' && item.review\">\n              <button class=\"btn contact\" @click=\"contactCustomerService\">联系客服</button>\n            </template>\n\n            <!-- 场景5: 已取消，有退款信息 (仅 查看退款详情) -->\n            <template v-else-if=\"item.status.startsWith('cancelled') && item.refundInfo\">\n              <button class=\"btn detail\" @click=\"viewRefundDetail(item)\">查看退款详情</button>\n            </template>\n          </view>\n        </view>\n      </view>\n    </view>\n    \n    <!-- 评价模态框 (保持不变) -->\n    <view class=\"modal-overlay\" v-if=\"reviewModalVisible\" @click=\"closeReviewModal\">\n      <view class=\"modal-content\" @click.stop>\n        <view class=\"modal-header\">\n          <text class=\"modal-title\">服务评价</text>\n          <text class=\"modal-close\" @click=\"closeReviewModal\">×</text>\n        </view>\n        <view class=\"modal-body\">\n          <view class=\"rating-section\">\n            <view class=\"stars\">\n              <text \n                v-for=\"star in 5\" \n                :key=\"star\" \n                class=\"star\" \n                :class=\"{ 'active': star <= reviewForm.rating }\" \n                @click=\"setRating(star)\"\n              >★</text>\n            </view>\n          </view>\n\n          <view class=\"comment-section\">\n             <textarea \n               v-model=\"reviewForm.comment\" \n               placeholder=\"服务满足您的期望吗？分享您的使用体验吧～\" \n               class=\"comment-textarea\"\n               maxlength=\"200\"\n             ></textarea>\n          </view>\n\n          <view class=\"image-section\">\n            <view class=\"image-uploader\">\n              <view class=\"image-preview\" v-for=\"(image, index) in reviewForm.images\" :key=\"index\">\n                <image :src=\"image\" mode=\"aspectFill\"></image>\n                <view class=\"remove-image\" @click=\"removeImage(index)\">×</view>\n              </view>\n              <view class=\"upload-btn\" @click=\"chooseImage\" v-if=\"reviewForm.images.length < 3\">\n                <text>+</text>\n              </view>\n            </view>\n            <text class=\"image-tip\">最多上传3张图片</text>\n          </view>\n\n          <view class=\"anonymous-section\">\n            <checkbox-group @change=\"toggleAnonymous\">\n              <label>\n                <checkbox :checked=\"reviewForm.anonymous\" /> 匿名评价\n              </label>\n            </checkbox-group>\n          </view>\n        </view>\n        <view class=\"modal-footer\">\n          <button class=\"submit-review-btn\" @click=\"submitReview\">提交评价</button>\n        </view>\n      </view>\n    </view>\n  </view>\n</template>\n\n<script setup>\nimport { ref, reactive } from 'vue'\nimport { onShow } from '@dcloudio/uni-app'\n\nconst appointments = ref([])\nconst loading = ref(true)\n\n// --- 评价模态框相关状态 ---\nconst reviewModalVisible = ref(false)\nconst selectedAppointment = ref(null)\nconst reviewForm = reactive({\n    rating: 5, // 默认5星好评\n    comment: '',\n    images: [], // 本地临时路径\n    imageUrls: [], // 上传后的云存储路径\n    anonymous: false // 新增匿名选项，默认不匿名\n})\n\n// --- 客服联系方式配置 ---\nconst CUSTOMER_SERVICE_CONTACTS = {\n    phone: '19357501597', // 您的客服电话\n    wechat: 'Chen_100peng', // 您的客服微信号\n    qq: '3327261595' // 您的客服QQ号\n};\n\n\nfunction translateStatus(status) {\n    const map = {\n        confirmed: '预约成功',\n        cancelled_by_worker: '师傅已取消',\n        cancelled_by_user: '用户已取消',\n        completed: '已完成'\n    }\n    return map[status] || status\n}\n\nasync function fetchAppointments() {\n    loading.value = true\n    const userinfo = uni.getStorageSync('userinfo')\n    if (!userinfo || !userinfo._id) {\n        uni.showToast({ title: '请先登录', icon: 'none' })\n        loading.value = false\n        return\n    }\n    try {\n        const res = await uniCloud.callFunction({\n            name: 'getUserAppointments',\n            data: { userId: userinfo._id }\n        })\n        if (res.result.success) {\n            appointments.value = res.result.data\n            console.log('获取到的预约数据:', appointments.value);\n        } else {\n            console.error('云函数返回错误', res.result.message)\n        }\n    } catch (e) {\n        console.error('调用云函数失败', e)\n    } finally {\n        loading.value = false\n    }\n}\n\n// 【修改】联系客服方法：弹出选择框\nconst contactCustomerService = () => {\n    uni.showActionSheet({\n        itemList: ['拨打电话', '复制微信号', '复制QQ号'],\n        success: (res) => {\n            if (res.tapIndex === 0) { // 拨打电话\n                uni.makePhoneCall({\n                    phoneNumber: CUSTOMER_SERVICE_CONTACTS.phone\n                });\n            } else if (res.tapIndex === 1) { // 复制微信号\n                // 使用 uni.setClipboardData 替代 document.execCommand('copy') 以提高兼容性\n                uni.setClipboardData({\n                    data: CUSTOMER_SERVICE_CONTACTS.wechat,\n                    success: () => {\n                        uni.showToast({\n                            title: '微信号已复制',\n                            icon: 'success'\n                        });\n                    },\n                    fail: (err) => {\n                        console.error('复制微信号失败:', err);\n                        uni.showToast({\n                            title: '复制失败，请手动复制',\n                            icon: 'none'\n                        });\n                    }\n                });\n            } else if (res.tapIndex === 2) { // 复制QQ号\n                // 使用 uni.setClipboardData 替代 document.execCommand('copy') 以提高兼容性\n                uni.setClipboardData({\n                    data: CUSTOMER_SERVICE_CONTACTS.qq,\n                    success: () => {\n                        uni.showToast({\n                            title: 'QQ号已复制',\n                            icon: 'success'\n                        });\n                    },\n                    fail: (err) => {\n                        console.error('复制QQ号失败:', err);\n                        uni.showToast({\n                            title: '复制失败，请手动复制',\n                            icon: 'none'\n                        });\n                    }\n                });\n            }\n        },\n        fail: (res) => {\n            console.log('用户取消选择', res.errMsg);\n        }\n    });\n};\n\n// 【新增】根据按钮数量动态返回类名 (保持不变)\nconst getButtonGroupClass = (item) => {\n  let buttonCount = 0;\n  // 场景1: 预约成功，服务时间未到 (取消 + 完成)\n  if (item.status === 'confirmed' && item.expectedEndTime && item.expectedEndTime > Date.now()) {\n    buttonCount = 2;\n  }\n  // 场景2: 预约成功，服务时间已过但未自动完成 (联系客服 + 完成服务)\n  else if (item.status === 'confirmed' && item.expectedEndTime && item.expectedEndTime <= Date.now()) {\n    buttonCount = 2;\n  }\n  // 场景3: 已完成，未评价 (联系客服 + 评价服务)\n  else if (item.status === 'completed' && !item.review) {\n    buttonCount = 2;\n  }\n  // 场景4: 已完成，已评价 (仅 联系客服)\n  else if (item.status === 'completed' && item.review) {\n    buttonCount = 1;\n  }\n  // 场景5: 已取消，有退款信息 (仅 查看退款详情)\n  else if (item.status.startsWith('cancelled') && item.refundInfo) {\n    buttonCount = 1;\n  }\n\n  return {\n    'justify-two-buttons': buttonCount === 2,\n    'justify-one-button': buttonCount === 1,\n  };\n};\n\n\n// 查看退款详情方法 (保持不变)\nconst viewRefundDetail = (appointmentItem) => {\n    let refundMessage = `总金额: ¥${(appointmentItem.total_fee / 100).toFixed(2)}\\n`;\n    if (appointmentItem.refundInfo) {\n        refundMessage += `用户退款: ¥${(appointmentItem.refundInfo.userRefundAmount / 100).toFixed(2)}\\n`;\n        refundMessage += `师傅补偿: ¥${(appointmentItem.refundInfo.workerCompensation / 100).toFixed(2)}\\n`;\n        refundMessage += `平台扣费: ¥${(appointmentItem.refundInfo.platformFee / 100).toFixed(2)}\\n`;\n        if (appointmentItem.refundInfo.refundNo) {\n             refundMessage += `退款单号: ${appointmentItem.refundInfo.refundNo}\\n`;\n        }\n        if (appointmentItem.refundInfo.refundAt) {\n            const refundDate = new Date(appointmentItem.refundInfo.refundAt);\n            refundMessage += `退款时间: ${refundDate.toLocaleString()}\\n`;\n        }\n    } else {\n        refundMessage += '无详细退款信息。';\n    }\n    uni.showModal({\n        title: '退款详情',\n        content: refundMessage,\n        showCancel: false,\n        confirmText: '确定'\n    });\n};\n\n\nasync function cancelAppointment(appointmentItem) {\n    // 前端再次校验，避免按钮未禁用但用户点击了\n    // 只有状态为 'confirmed' 且预计结束时间未到才能取消\n    if (appointmentItem.status !== 'confirmed' || !appointmentItem.expectedEndTime || appointmentItem.expectedEndTime <= Date.now()) {\n        uni.showToast({ title: '该预约无法取消', icon: 'none' });\n        // 这里可以根据情况引导联系客服，但由于按钮已经根据逻辑显示，这里不再重复弹窗\n        return;\n    }\n\n    const res = await uni.showModal({\n        title: '确认取消预约？',\n        editable: true,\n        placeholderText: '请输入取消原因（必填）',\n        confirmText: '确认取消',\n        cancelText: '点错了'\n    });\n\n    if (res.confirm) {\n        const reason = res.content;\n        \n        if (!reason || !reason.trim()) {\n            uni.showToast({ title: '必须填写取消原因', icon: 'none' });\n            return;\n        }\n\n        uni.showLoading({ title: '正在取消...' });\n\n        try {\n            const userinfo = uni.getStorageSync('userinfo');\n            if (!userinfo || !userinfo._id) {\n                throw new Error('无法获取用户信息，请重新登录');\n            }\n            \n            const dataToSend = {\n                appointmentId: appointmentItem._id,\n                cancellationReason: reason,\n                userId: userinfo._id\n            };\n            console.log('即将发送给 cancelAppointmentByUser 云函数的参数:', dataToSend);\n\n            const result = await uniCloud.callFunction({\n                name: 'cancelAppointmentByUser',\n                data: dataToSend\n            });\n\n            if (result.result.success) {\n                uni.showToast({ title: '取消成功', icon: 'success' });\n                fetchAppointments();\n            } else {\n                throw new Error(result.result.message || '取消失败');\n            }\n        } catch (error) {\n            uni.showToast({ title: error.message, icon: 'none' });\n        } finally {\n            uni.hideLoading();\n        }\n    }\n}\n\nasync function completeAppointment(appointmentItem) {\n    const res = await uni.showModal({\n        title: '确认完成服务？',\n        content: '完成后可选择评价',\n    })\n    if (!res.confirm) return\n\n    uni.showLoading({ title: '请稍候...' })\n    try {\n        const res = await uniCloud.callFunction({\n            name: 'updateAppointmentStatusByuser',\n            data: {\n                appointmentId: appointmentItem._id,\n                status: 'completed'\n            }\n        })\n        if (res.result.success) {\n            uni.showToast({ title: '服务已完成', icon: 'success' })\n            fetchAppointments()\n        } else {\n            uni.showToast({ title: '操作失败', icon: 'none' })\n        }\n    } catch (e) {\n        uni.showToast({ title: '操作失败', icon: 'none' })\n    } finally {\n        uni.hideLoading()\n    }\n}\n\n// --- 评价模态框方法 (保持不变) ---\nfunction openReviewModal(appointmentItem) {\n    selectedAppointment.value = appointmentItem\n    reviewForm.rating = 5\n    reviewForm.comment = ''\n    reviewForm.images = []\n    reviewForm.imageUrls = []\n    reviewForm.anonymous = false\n    reviewModalVisible.value = true\n}\n\nfunction closeReviewModal() {\n    reviewModalVisible.value = false\n}\n\nfunction setRating(star) {\n    reviewForm.rating = star\n}\n\nasync function chooseImage() {\n    try {\n        const res = await uni.chooseImage({\n            count: 3 - reviewForm.images.length,\n            sizeType: ['compressed'],\n            sourceType: ['album', 'camera'],\n        })\n        reviewForm.images.push(...res.tempFilePaths)\n    } catch (e) {\n        // 用户取消选择\n    }\n}\n\nfunction removeImage(index) {\n    reviewForm.images.splice(index, 1)\n}\n\nfunction toggleAnonymous(e) {\n    reviewForm.anonymous = e.detail.value.length > 0\n}\n\nasync function submitReview() {\n    uni.showLoading({ title: '正在提交...' })\n\n    const userinfo = uni.getStorageSync('userinfo')\n    let reviewerName = ''\n    let reviewerAvatar = '/static/images/avatar-placeholder.png'\n    if (!reviewForm.anonymous && userinfo) {\n        if (userinfo.name) reviewerName = userinfo.name\n        if (userinfo.avatar) reviewerAvatar = userinfo.avatar\n    }\n\n    try {\n        for (const imagePath of reviewForm.images) {\n            const uploadResult = await uniCloud.uploadFile({\n                filePath: imagePath,\n                cloudPath: `review-images/${Date.now()}-${Math.random().toString(36).substring(2)}.jpg`,\n                cloudPathAsRealPath: true,\n            })\n            reviewForm.imageUrls.push(uploadResult.fileID)\n        }\n    } catch (e) {\n        uni.hideLoading()\n        uni.showToast({ title: '图片上传失败', icon: 'none' })\n        return\n    }\n\n    try {\n        const res = await uniCloud.callFunction({\n            name: 'submitReview',\n            data: {\n                appointmentId: selectedAppointment.value._id,\n                workerPhone: selectedAppointment.value.workerPhone,\n                reviewData: {\n                    rating: reviewForm.rating,\n                    comment: reviewForm.comment,\n                    images: reviewForm.imageUrls,\n                    name: reviewerName,\n                    avatar: reviewerAvatar\n                }\n            }\n        })\n        uni.hideLoading()\n        if (res.result.success) {\n            uni.showToast({ title: '评价成功', icon: 'success' })\n            closeReviewModal()\n            fetchAppointments()\n        } else {\n            uni.showToast({ title: res.result.message || '提交失败', icon: 'none' })\n        }\n    } catch (e) {\n        uni.hideLoading()\n        uni.showToast({ title: '提交失败，请重试', icon: 'none' })\n    }\n}\n\nonShow(fetchAppointments)\n</script>\n\n<style scoped>\n/* 全局页面容器 */\n.page-container {\n  background-color: #f2f2f7;\n  min-height: 100vh;\n  padding: 24rpx;\n  box-sizing: border-box;\n}\n\n/* 加载 & 空白 提示 */\n.feedback-view {\n  display: flex;\n  flex-direction: column; /* 调整为列方向 */\n  justify-content: center;\n  align-items: center;\n  height: 60vh;\n  color: #8e8e93;\n  font-size: 32rpx;\n}\n\n/* 列表容器 */\n.appointment-list {\n  display: flex;\n  flex-direction: column;\n  gap: 24rpx;\n  margin-top: 20rpx;\n}\n\n/* 卡片容器 */\n.appointment-card {\n  background: #ffffff;\n  border-radius: 20rpx;\n  overflow: hidden;\n  box-shadow: 0 4rpx 12rpx rgba(0, 0, 0, 0.06);\n  transition: transform 0.2s, box-shadow 0.2s;\n}\n\n.appointment-card:active {\n  transform: scale(0.99);\n  box-shadow: 0 2rpx 8rpx rgba(0, 0, 0, 0.1);\n}\n\n/* 卡片内容 */\n.card-body {\n  padding: 32rpx;\n  display: flex;\n  flex-direction: column;\n  gap: 20rpx;\n}\n\n/* 信息行 */\n.info-row {\n  display: flex;\n  justify-content: space-between;\n  align-items: flex-start;\n  font-size: 28rpx;\n  line-height: 1.4;\n}\n\n.info-row .label {\n  color: #8e8e93;\n  width: 160rpx;\n  flex-shrink: 0;\n}\n\n.info-row .value {\n  color: #1c1c1e;\n  text-align: right;\n  flex: 1;\n  word-break: break-all;\n}\n\n/* 状态文字 */\n.status-text {\n  font-weight: 500;\n}\n.status-text.status-confirmed {\n  color: #007aff;\n}\n.status-text.status-completed {\n  color: #34c759;\n}\n.status-text.status-cancelled_by_worker,\n.status-text.status-cancelled_by_user {\n  color: #ff3b30;\n}\n\n/* 卡片底部按钮区域 */\n.card-footer {\n  border-top: 1rpx solid #e5e5e5;\n  padding: 20rpx 32rpx;\n}\n\n/* 按钮组 */\n.button-group {\n  display: flex;\n  gap: 20rpx; /* 按钮间距 */\n  /* 动态类将控制 justify-content */\n}\n\n.button-group.justify-two-buttons {\n  justify-content: space-between; /* 两个按钮时左右对齐 */\n}\n\n.button-group.justify-one-button {\n  justify-content: flex-end; /* 一个按钮时右对齐 */\n}\n\n\n.button-group .btn {\n  flex: 1; /* 允许按钮平均分配空间并填充 */\n  max-width: 280rpx; /* 限制按钮的最大宽度，防止过宽 */\n  padding: 30rpx 0; /* 垂直内边距增至 30rpx */\n  font-size: 26rpx;\n  border-radius: 40rpx;\n  line-height: 1;\n  text-align: center;\n  transition: background-color 0.2s, transform 0.2s, opacity 0.2s;\n}\n\n.button-group .btn:active {\n  opacity: 0.8;\n  transform: scale(0.98);\n}\n\n.button-group .cancel {\n  background-color: #fff;\n  color: #ff3b30;\n  border: 1rpx solid #ff3b30;\n}\n\n.button-group .finish {\n  background-color: #34c759;\n  color: #fff;\n  border: 1rpx solid #34c759;\n}\n\n.button-group .review {\n  background-color: #007aff;\n  color: #fff;\n  border: 1rpx solid #007aff;\n}\n\n.button-group .contact { /* 联系客服按钮样式 */\n  background-color: #fff; /* 调整为白色背景 */\n  color: #007aff; /* 蓝色文字 */\n  border: 1rpx solid #007aff; /* 蓝色边框 */\n}\n\n.button-group .detail { /* 查看退款详情按钮样式 */\n  background-color: #e0e0e0;\n  color: #333;\n  border: 1rpx solid #e0e0e0;\n}\n\n\n/* 评价模态框背景 */\n.modal-overlay {\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background-color: rgba(0, 0, 0, 0.5);\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  z-index: 1000;\n}\n\n/* 评价模态框主体 */\n.modal-content {\n  width: 90%;\n  max-width: 680rpx;\n  background: #ffffff;\n  border-radius: 24rpx;\n  overflow: hidden;\n  box-shadow: 0 8rpx 30rpx rgba(0,0,0,0.12);\n  display: flex;\n  flex-direction: column;\n}\n\n/* 模态框顶部 */\n.modal-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 24rpx 32rpx;\n  border-bottom: 1rpx solid #e5e5e5;\n}\n\n.modal-header .modal-title {\n  font-size: 34rpx;\n  font-weight: 600;\n  color: #1c1c1e;\n}\n.modal-header .modal-close {\n  font-size: 40rpx;\n  color: #8e8e93;\n}\n\n/* 模态框内容 */\n.modal-body {\n  padding: 32rpx;\n  display: flex;\n  flex-direction: column;\n  gap: 32rpx;\n}\n\n/* 刻度星星区域 */\n.stars {\n  display: flex;\n  justify-content: center;\n  gap: 20rpx;\n}\n.stars .star {\n  font-size: 60rpx;\n  color: #e0e0e0;\n  transition: color 0.2s, transform 0.2s;\n}\n.stars .star.active {\n  color: #ffc107;\n}\n.stars .star:active {\n  transform: scale(1.2);\n}\n\n/* 评论文本框 */\n.comment-textarea {\n  width: 100%;\n  height: 180rpx;\n  padding: 20rpx;\n  background-color: #f2f2f7;\n  border: none;\n  border-radius: 16rpx;\n  font-size: 28rpx;\n  color: #1c1c1e;\n  box-sizing: border-box;\n}\n\n/* 图片上传区域 */\n.image-uploader {\n  display: flex;\n  flex-wrap: wrap;\n  gap: 20rpx;\n}\n.image-uploader .upload-btn,\n.image-uploader .image-preview {\n  width: 160rpx;\n  height: 160rpx;\n  border-radius: 16rpx;\n}\n\n.upload-btn {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  background: #f2f2f7;\n  border: 1rpx dashed #ccc;\n  font-size: 60rpx;\n  color: #ccc;\n}\n\n.image-preview {\n  position: relative;\n  overflow: hidden;\n}\n.image-preview image {\n  width: 100%;\n  height: 100%;\n  object-fit: cover;\n}\n\n.remove-image {\n  position: absolute;\n  top: -8rpx;\n  right: -8rpx;\n  width: 40rpx;\n  height: 40rpx;\n  background: rgba(0,0,0,0.6);\n  color: #fff;\n  border-radius: 50%;\n  font-size: 28rpx;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.image-tip {\n  margin-top: 10rpx;\n  font-size: 24rpx;\n  color: #8e8e93;\n  text-align: right;\n}\n\n/* 匿名选项 */\n.anonymous-section {\n  display: flex;\n  align-items: center;\n  padding: 0 32rpx;\n}\n.checkbox-group label {\n  display: flex;\n  align-items: center;\n  font-size: 28rpx;\n  color: #1c1c1e;\n}\n.checkbox-group checkbox {\n  margin-right: 10rpx;\n}\n\n/* 提交按钮 */\n.submit-review-btn {\n  background: #007aff;\n  color: #fff;\n  text-align: center;\n  font-size: 32rpx;\n  padding: 24rpx 0;\n  border-radius: 16rpx;\n  border: none;\n  margin: 0 32rpx 32rpx;\n}\n/* ===== 按钮大小调整（附加至文件末尾） ===== */\n/* 统一设置所有按钮的 flex 行为和最大宽度 */\n.button-group .btn {\n  flex: 1; /* 允许按钮平均分配空间并填充 */\n  max-width: 280rpx; /* 限制按钮的最大宽度，防止过宽 */\n  padding: 30rpx 0; /* 垂直内边距增至 30rpx */\n  font-weight: 500; /* 统一字体粗细 */\n  /* 其他样式保持不变 */\n}\n</style>\n","import MiniProgramPage from 'D:/peng.folder/fengdian-main/fengdian-main/pages/user-schedule/user-schedule.vue'\ntt.createPage(MiniProgramPage)"],"names":["ref","reactive","uni","uniCloud","res","onShow"],"mappings":"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"}