{"version":3,"file":"newsDetail.js","sources":["pages/newsDetail/newsDetail.vue","../../../HBuilderX.4.66.2025051912/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvbmV3c0RldGFpbC9uZXdzRGV0YWlsLnZ1ZQ"],"sourcesContent":["<template>\n  <view class=\"container\">\n    <view v-if=\"!detail\" style=\"padding:80rpx 30rpx;\">\n      <uni-skeleton title :row=\"5\" />\n    </view>\n\n    <view v-else class=\"detail\">\n      <view class=\"title\">\n        {{ detail.title }}\n      </view>\n      <view class=\"info\">\n        <view class=\"left\">      \n          <text>{{ detail.publish_date }}</text> \n          <text>{{ detail.author }}</text>\n          <text>{{ detail.view_count }}阅读</text>\n        </view>\n        <view class=\"right\">\n          <uni-icons type=\"paperplane\" size=\"18\" class=\"icon-class\" />\n          <text>分享</text>\n        </view>\n      </view>\n      <view class=\"content\">    \n        <rich-text :nodes=\"detail.content\"></rich-text>\n      </view>\n    </view>\n  </view>\n</template>\n\n<script setup>\nimport { ref } from 'vue';\nimport { onLoad } from '@dcloudio/uni-app';\n\nconst detail = ref(null);\n\n// 格式化数字（阅读数）\nfunction formatNum(n) {\n  return n > 10000 ? (n / 10000).toFixed(1) + '万' : n;\n}\n\n// 格式化时间（这里简化，原逻辑是格式化为月-日）\nfunction formatTime(d) {\n  if (!d) return '';\n  const dt = new Date(d);\n  return `${dt.getMonth() + 1}-${dt.getDate()}`;\n}\n\nonLoad((options) => {\n  const id = options.id;\n  getDetail(id);\n});\n\n// 获取新闻详情\nasync function getDetail(id) {\n  try {\n    uni.showLoading({ title: '加载中...' });\n    const res = await uniCloud.callFunction({\n      name: 'getNewsDetail',\n      data: { id }\n    });\n    \n    if (res.result && res.result.data) {\n      const data = res.result.data;\n      \n      // 格式化处理\n      data.publish_date = formatTime(data.publish_date);\n      data.view_count = formatNum(data.view_count);\n      \n      // 处理内容样式\n      data.content = data.content.replace(/<p/gi, \"<p class='pstyle'\"); \n      data.content = data.content.replace(/<img/gi, \"<img class='imgstyle'\"); \n      \n      detail.value = data;\n    }\n  } catch (error) {\n    console.error('获取新闻详情失败', error);\n    uni.showToast({ title: '加载失败', icon: 'none' });\n  } finally {\n    uni.hideLoading();\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.container {\n  background-color: #fff;\n  min-height: 100vh;\n}\n\n.detail {\n  padding: 30rpx;\n  .title {\n    font-size: 60rpx;\n    line-height: 1.5em;\n    font-weight: 600;\n  }\n  .info {\n    font-size: 28rpx;\n    color: #999;\n    display: flex;\n    justify-content: space-between;\n    padding: 30rpx 0 50rpx;\n    .left {\n      text {\n        padding-right: 15rpx;\n      }\n    }\n    .right {\n      display: flex;\n      align-items: center;\n      color: var(--themeColor);\n      position: relative;\n      .share {\n        position: absolute;\n        top: 0;\n        left: 0;\n        opacity: 0;\n      }\n      text {\n        padding-left: 5rpx;\n      }\n    }\n  }\n  .content {\n    .pstyle {\n      padding: 10rpx 0;\n      line-height: 1.6em;\n    }\n    .imgstyle {\n      border-radius: 10rpx;\n      width: 100%;\n      height: 100%;\n    }\n  }\n}\n</style>\n","import MiniProgramPage from 'D:/peng.folder/fengdian-main/蜂点到家/pages/newsDetail/newsDetail.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","onLoad","uni","uniCloud"],"mappings":";;;;;;;;;;;;;;AAgCA,UAAM,SAASA,cAAAA,IAAI,IAAI;AAGvB,aAAS,UAAU,GAAG;AACpB,aAAO,IAAI,OAAS,IAAI,KAAO,QAAQ,CAAC,IAAI,MAAM;AAAA,IACpD;AAGA,aAAS,WAAW,GAAG;AACrB,UAAI,CAAC;AAAG,eAAO;AACf,YAAM,KAAK,IAAI,KAAK,CAAC;AACrB,aAAO,GAAG,GAAG,aAAa,CAAC,IAAI,GAAG,QAAS,CAAA;AAAA,IAC7C;AAEAC,kBAAM,OAAC,CAAC,YAAY;AAClB,YAAM,KAAK,QAAQ;AACnB,gBAAU,EAAE;AAAA,IACd,CAAC;AAGD,mBAAe,UAAU,IAAI;AAC3B,UAAI;AACFC,sBAAAA,MAAI,YAAY,EAAE,OAAO,SAAU,CAAA;AACnC,cAAM,MAAM,MAAMC,cAAQ,GAAC,aAAa;AAAA,UACtC,MAAM;AAAA,UACN,MAAM,EAAE,GAAI;AAAA,QAClB,CAAK;AAED,YAAI,IAAI,UAAU,IAAI,OAAO,MAAM;AACjC,gBAAM,OAAO,IAAI,OAAO;AAGxB,eAAK,eAAe,WAAW,KAAK,YAAY;AAChD,eAAK,aAAa,UAAU,KAAK,UAAU;AAG3C,eAAK,UAAU,KAAK,QAAQ,QAAQ,QAAQ,mBAAmB;AAC/D,eAAK,UAAU,KAAK,QAAQ,QAAQ,UAAU,uBAAuB;AAErE,iBAAO,QAAQ;AAAA,QAChB;AAAA,MACF,SAAQ,OAAO;AACdD,sBAAA,MAAA,MAAA,SAAA,yCAAc,YAAY,KAAK;AAC/BA,sBAAG,MAAC,UAAU,EAAE,OAAO,QAAQ,MAAM,OAAM,CAAE;AAAA,MACjD,UAAY;AACRA,sBAAG,MAAC,YAAW;AAAA,MAChB;AAAA,IACH;;;;;;;;;;;;;;;;;;;;;;;;AC9EA,GAAG,WAAW,eAAe;"}