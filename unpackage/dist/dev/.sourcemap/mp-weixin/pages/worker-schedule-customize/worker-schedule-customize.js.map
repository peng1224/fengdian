{"version":3,"file":"worker-schedule-customize.js","sources":["pages/worker-schedule-customize/worker-schedule-customize.vue","../../HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvd29ya2VyLXNjaGVkdWxlLWN1c3RvbWl6ZS93b3JrZXItc2NoZWR1bGUtY3VzdG9taXplLnZ1ZQ"],"sourcesContent":["<template>\n  <view class=\"container\">\n    <!-- 顶部：日期横向选择 -->\n    <scroll-view class=\"date-bar\" scroll-x show-scrollbar=\"false\">\n      <view\n        v-for=\"(day, idx) in days\"\n        :key=\"idx\"\n        class=\"date-item\"\n        :class=\"{ active: selectedDate===day.dateString }\"\n        @click=\"selectDate(day.dateString)\"\n      >\n        <text class=\"day-name\">{{ day.name }}</text>\n        <text class=\"day-date\">{{ day.shortDate }}</text>\n      </view>\n    </scroll-view>\n\n    <!-- 中部：小时格子，点亮表示可预约 -->\n    <view class=\"slots-grid\">\n      <view \n        v-for=\"h in hours\" \n        :key=\"h\" \n        class=\"slot-item\"\n        :class=\"{ enabled: enabledSlots.includes(h) }\"\n        @click=\"toggleHour(h)\"\n      >\n        {{ h }}\n      </view>\n    </view>\n\n    <!-- 底部：保存按钮 -->\n    <button class=\"save-btn\" @click=\"save\">保存设置</button>\n  </view>\n</template>\n\n<script setup>\nimport { ref, onMounted } from 'vue';\nimport { onLoad } from '@dcloudio/uni-app';\n\nconst days = ref([]);\nconst hours = Array.from({ length: 10 }, (_, i) => `${9+i}:00`);\nconst selectedDate = ref('');\nconst enabledSlots = ref([]);\n\n// 1. 生成未来 7 天\nfunction genDays() {\n  const today = new Date(), names = ['今天','明天','后天'];\n  for(let i=0;i<7;i++){\n    const d=new Date(today); d.setDate(today.getDate()+i);\n    const mm=String(d.getMonth()+1).padStart(2,'0'), dd=String(d.getDate()).padStart(2,'0');\n    days.value.push({\n      name: i<3?names[i]:`周${'日一二三四五六'[d.getDay()]}`,\n      shortDate:`${mm}-${dd}`,\n      dateString:`${d.getFullYear()}-${mm}-${dd}`\n    });\n  }\n  selectedDate.value = days.value[0].dateString;\n}\n\n// 2. 读云函数拉取已有设置\nasync function loadSettings() {\n  const user=uni.getStorageSync('userinfo');\n  const res=await uniCloud.callFunction({\n    name:'getScheduleSettings',\n    data:{ workerId:user._id }\n  });\n  if(res.result.success){\n    const map=res.result.data.find(e=>e.date===selectedDate.value);\n    enabledSlots.value = map? map.hours : [...hours];\n  }\n}\n\n// 3. 切换日期\nasync function selectDate(d){\n  selectedDate.value=d;\n  await loadSettings();\n}\n\n// 4. 点击格子切换开关\nfunction toggleHour(h){\n  const idx=enabledSlots.value.indexOf(h);\n  if(idx>=0) enabledSlots.value.splice(idx,1);\n  else enabledSlots.value.push(h);\n}\n\n// 5. 保存到云函数\nasync function save(){\n  const user=uni.getStorageSync('userinfo');\n  uni.showLoading({title:'保存中...'});\n  const res=await uniCloud.callFunction({\n    name:'updateScheduleSettings',\n    data:{\n      workerId:user._id,\n      date:selectedDate.value,\n      hours: enabledSlots.value\n    }\n  });\n  uni.hideLoading();\n  if(res.result.success) uni.showToast({title:'保存成功',icon:'success'});\n  else uni.showToast({title:res.result.message||'保存失败',icon:'none'});\n}\n\nonLoad(()=>{\n  genDays();\n  loadSettings();\n});\n</script>\n\n<style scoped>\n.container { padding:30rpx; background:#fff; flex:1; }\n.date-bar { display:flex; margin-bottom:20rpx; }\n.date-item { padding:10rpx 20rpx; border-radius:12rpx; background:#f0f0f0; margin-right:10rpx; }\n.date-item.active { background:#007aff; color:#fff; }\n.slots-grid { display:grid; grid-template-columns:repeat(5,1fr); gap:10rpx; margin-bottom:30rpx; }\n.slot-item { text-align:center; padding:15rpx 0; border:1px solid #ddd; border-radius:12rpx; }\n.slot-item.enabled { background:#007aff; color:#fff; border-color:#007aff; }\n.save-btn { width:100%; padding:20rpx; background:#007aff; color:#fff; border-radius:12rpx; text-align:center; }\n</style>\n","import MiniProgramPage from 'F:/uni-app代码文件/蜂点通uni-app+uniCloud/pages/worker-schedule-customize/worker-schedule-customize.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","uni","uniCloud","onLoad"],"mappings":";;;;;AAsCA,UAAM,OAAOA,cAAAA,IAAI,CAAA,CAAE;AACnB,UAAM,QAAQ,MAAM,KAAK,EAAE,QAAQ,GAAE,GAAI,CAAC,GAAG,MAAM,GAAG,IAAE,CAAC,KAAK;AAC9D,UAAM,eAAeA,cAAAA,IAAI,EAAE;AAC3B,UAAM,eAAeA,cAAAA,IAAI,CAAA,CAAE;AAG3B,aAAS,UAAU;AACjB,YAAM,QAAQ,oBAAI,QAAQ,QAAQ,CAAC,MAAK,MAAK,IAAI;AACjD,eAAQ,IAAE,GAAE,IAAE,GAAE,KAAI;AAClB,cAAM,IAAE,IAAI,KAAK,KAAK;AAAG,UAAE,QAAQ,MAAM,QAAS,IAAC,CAAC;AACpD,cAAM,KAAG,OAAO,EAAE,SAAU,IAAC,CAAC,EAAE,SAAS,GAAE,GAAG,GAAG,KAAG,OAAO,EAAE,QAAO,CAAE,EAAE,SAAS,GAAE,GAAG;AACtF,aAAK,MAAM,KAAK;AAAA,UACd,MAAM,IAAE,IAAE,MAAM,CAAC,IAAE,IAAI,UAAU,EAAE,OAAM,CAAE,CAAC;AAAA,UAC5C,WAAU,GAAG,EAAE,IAAI,EAAE;AAAA,UACrB,YAAW,GAAG,EAAE,YAAW,CAAE,IAAI,EAAE,IAAI,EAAE;AAAA,QAC/C,CAAK;AAAA,MACF;AACD,mBAAa,QAAQ,KAAK,MAAM,CAAC,EAAE;AAAA,IACrC;AAGA,mBAAe,eAAe;AAC5B,YAAM,OAAKC,cAAAA,MAAI,eAAe,UAAU;AACxC,YAAM,MAAI,MAAMC,cAAQ,GAAC,aAAa;AAAA,QACpC,MAAK;AAAA,QACL,MAAK,EAAE,UAAS,KAAK,IAAK;AAAA,MAC9B,CAAG;AACD,UAAG,IAAI,OAAO,SAAQ;AACpB,cAAM,MAAI,IAAI,OAAO,KAAK,KAAK,OAAG,EAAE,SAAO,aAAa,KAAK;AAC7D,qBAAa,QAAQ,MAAK,IAAI,QAAQ,CAAC,GAAG,KAAK;AAAA,MAChD;AAAA,IACH;AAGA,mBAAe,WAAW,GAAE;AAC1B,mBAAa,QAAM;AACnB,YAAM,aAAY;AAAA,IACpB;AAGA,aAAS,WAAW,GAAE;AACpB,YAAM,MAAI,aAAa,MAAM,QAAQ,CAAC;AACtC,UAAG,OAAK;AAAG,qBAAa,MAAM,OAAO,KAAI,CAAC;AAAA;AACrC,qBAAa,MAAM,KAAK,CAAC;AAAA,IAChC;AAGA,mBAAe,OAAM;AACnB,YAAM,OAAKD,cAAAA,MAAI,eAAe,UAAU;AACxCA,oBAAAA,MAAI,YAAY,EAAC,OAAM,SAAQ,CAAC;AAChC,YAAM,MAAI,MAAMC,cAAQ,GAAC,aAAa;AAAA,QACpC,MAAK;AAAA,QACL,MAAK;AAAA,UACH,UAAS,KAAK;AAAA,UACd,MAAK,aAAa;AAAA,UAClB,OAAO,aAAa;AAAA,QACrB;AAAA,MACL,CAAG;AACDD,oBAAG,MAAC,YAAW;AACf,UAAG,IAAI,OAAO;AAASA,4BAAI,UAAU,EAAC,OAAM,QAAO,MAAK,UAAS,CAAC;AAAA;AAC7DA,sBAAAA,MAAI,UAAU,EAAC,OAAM,IAAI,OAAO,WAAS,QAAO,MAAK,OAAM,CAAC;AAAA,IACnE;AAEAE,kBAAAA,OAAO,MAAI;AACT;AACA;IACF,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;ACvGD,GAAG,WAAW,eAAe;"}